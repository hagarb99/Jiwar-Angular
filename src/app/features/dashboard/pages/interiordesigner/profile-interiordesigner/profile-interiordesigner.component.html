<div class="min-h-screen bg-gray-50/50 pb-12">
    <p-toast></p-toast>

    <div *ngIf="loading" class="flex items-center justify-center h-screen text-gray-400">
        <div class="animate-pulse">Loading profile...</div>
    </div>

    <div *ngIf="!loading && profile" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pt-6">
        <!-- Header / Banner -->
        <div
            class="relative w-full h-48 sm:h-64 bg-gradient-to-r from-blue-900 via-indigo-900 to-slate-900 rounded-3xl overflow-hidden shadow-sm">
            <!-- Decorative background elements could go here -->
            <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]">
            </div>
        </div>


        <div class="relative px-6 sm:px-10 pb-6 -mt-20 sm:-mt-24 mb-6">
            <div class="flex flex-col md:flex-row items-start md:items-end justify-between gap-6">

                <!-- Avatar & Info -->
                <div class="flex flex-col sm:flex-row items-center sm:items-end gap-6">
                    <div
                        class="w-32 h-32 sm:w-40 sm:h-40 rounded-full bg-white p-1.5 shadow-xl ring-1 ring-gray-100/100">
                        <img [src]="profile.profilePicURL || 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + profile.name"
                            class="w-full h-full rounded-full object-cover bg-gray-100" alt="{{profile.name}}">
                    </div>
                    <div class="text-center sm:text-left mb-2">
                        <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight">{{ profile.name }}</h1>
                        <p class="text-lg text-gray-600 font-medium">{{ profile.title || 'Interior Designer' }}</p>
                        <div class="flex items-center justify-center sm:justify-start gap-2 mt-1 text-gray-500 text-sm">
                            <!-- Location Icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z" />
                                <circle cx="12" cy="10" r="3" />
                            </svg>
                            <span>{{ profile.location || 'Location not set' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Edit Button -->
                <a routerLink="edit"
                    class="px-6 py-2.5 rounded-xl bg-gray-900 text-white font-medium shadow-lg shadow-gray-200 hover:bg-black transition-all hover:-translate-y-0.5 active:translate-y-0 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" />
                    </svg>
                    Edit Profile
                </a>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div *ngFor="let stat of profile.stats"
                class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 hover:border-gray-200 transition-colors">
                <p class="text-sm text-gray-500 font-medium mb-1">{{ stat.label }}</p>
                <p class="text-2xl font-bold text-gray-900">{{ stat.value }}</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Left Column: About & Contact -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Bio -->
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                        <span class="p-2 bg-blue-50 text-blue-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M2 21a8 8 0 0 1 13.292-6" />
                                <circle cx="10" cy="8" r="5" />
                                <path d="M19 16v6" />
                                <path d="M22 19h-6" />
                            </svg>
                        </span>
                        About Me
                    </h2>
                    <a *ngIf="!profile.bio" routerLink="/dashboard/interiordesigner/profile/edit"
                        class="text-xs text-blue-600 hover:underline">Add Bio</a>
                </div>
                <p *ngIf="profile.bio" class="text-gray-600 leading-relaxed whitespace-pre-line">
                    {{ profile.bio }}
                </p>
                <div *ngIf="!profile.bio" class="py-4 px-6 rounded-2xl bg-gray-50 border border-dashed border-gray-200">
                    <p class="text-gray-400 italic text-sm">No bio information provided yet. Tell clients about your
                        unique style and approach!</p>
                </div>

                <!-- Contact Info -->
                <div class="bg-white rounded-3xl p-8 shadow-sm border border-gray-100">
                    <h2 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-2">
                        <span class="p-2 bg-green-50 text-green-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                            </svg>
                        </span>
                        Contact Information
                    </h2>
                    <div class="grid sm:grid-cols-2 gap-6">
                        <div class="p-4 rounded-2xl bg-gray-50 border border-gray-100">
                            <span class="block text-xs text-gray-400 uppercase tracking-wider font-semibold mb-1">Email
                                Address</span>
                            <span class="text-gray-900 font-medium break-all">{{ profile.email }}</span>
                        </div>
                        <div class="p-4 rounded-2xl bg-gray-50 border border-gray-100">
                            <span class="block text-xs text-gray-400 uppercase tracking-wider font-semibold mb-1">Phone
                                Number</span>
                            <span class="text-gray-900 font-medium">{{ profile.phoneNumber || 'N/A' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Reviews Section -->
                <div class="bg-white rounded-3xl p-8 shadow-sm border border-gray-100">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                            <span class="p-2 bg-amber-50 text-amber-600 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polygon
                                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                                </svg>
                            </span>
                            Client Reviews
                        </h2>

                        <div class="flex items-center gap-4">
                            <a routerLink="/dashboard/designer/reviews"
                                class="text-amber-600 hover:text-amber-700 text-sm font-semibold flex items-center gap-1 group">
                                View Full Page
                                <i
                                    class="pi pi-arrow-right text-[10px] group-hover:translate-x-1 transition-transform"></i>
                            </a>
                            <div *ngIf="averageRating > 0"
                                class="flex items-center gap-2 bg-amber-50 px-4 py-2 rounded-xl border border-amber-100">
                                <span class="text-amber-600 font-bold text-lg">{{ averageRating | number:'1.1-1'
                                    }}</span>
                                <div class="flex text-amber-400">
                                    <i class="pi pi-star-fill text-sm"></i>
                                </div>
                                <span class="text-gray-400 text-sm">({{ totalReviews }})</span>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="pagedReviews && pagedReviews.length > 0" class="space-y-6">
                        <div *ngFor="let review of pagedReviews"
                            class="group p-6 rounded-2xl bg-white border border-gray-100 hover:border-amber-200 hover:shadow-md transition-all">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 overflow-hidden">
                                        <img [src]="'https://api.dicebear.com/7.x/initials/svg?seed=' + review.propertyOwnerName"
                                            alt="avatar">
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-gray-900">{{ review.propertyOwnerName }}</h4>
                                        <p class="text-xs text-gray-400">{{ review.createdAt | date:'mediumDate' }}</p>
                                    </div>
                                </div>
                                <div class="flex gap-0.5 text-amber-400">
                                    <i *ngFor="let i of [1,2,3,4,5]" class="pi"
                                        [ngClass]="i <= review.rating ? 'pi-star-fill' : 'pi-star'"></i>
                                </div>
                            </div>
                            <div class="text-gray-600 italic leading-relaxed relative">
                                <span class="block overflow-hidden transition-all duration-300">
                                    "{{ isReviewExpanded(review.id) ? review.comment :
                                    getTruncatedComment(review.comment) }}"
                                </span>
                                <button *ngIf="review.comment.length > 100" (click)="toggleReview(review.id)"
                                    class="text-amber-600 hover:text-amber-700 text-xs font-bold mt-2 focus:outline-none flex items-center gap-1">
                                    {{ isReviewExpanded(review.id) ? 'See Less' : 'See More' }}
                                    <i class="pi"
                                        [ngClass]="isReviewExpanded(review.id) ? 'pi-chevron-up' : 'pi-chevron-down'"
                                        style="font-size: 8px"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Pagination Controls -->
                        <div class="pt-4 border-t border-gray-50">
                            <p-paginator [first]="first" [rows]="rows" [totalRecords]="totalReviews"
                                (onPageChange)="onPageChange($event)" [showCurrentPageReport]="true"
                                currentPageReportTemplate="{first} - {last} of {totalRecords}"
                                [showFirstLastIcon]="false" styleClass="custom-paginator">
                            </p-paginator>
                        </div>
                    </div>

                    <div *ngIf="!reviews || reviews.length === 0"
                        class="text-center py-12 px-4 rounded-3xl bg-gray-50 border border-dashed border-gray-200">
                        <div
                            class="w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm">
                            <i class="pi pi-star text-2xl text-gray-300"></i>
                        </div>
                        <h3 class="text-gray-900 font-bold mb-1">No reviews yet</h3>
                        <p class="text-gray-500 text-sm">Complete projects to start receiving feedback from clients.</p>
                    </div>
                </div>
            </div>

            <!-- Right Column: Skills & Certs -->
            <div class="space-y-8">
                <!-- Specializations -->
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                        <span class="p-2 bg-purple-50 text-purple-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M12 2v20" />
                                <path d="M2 12h20" />
                                <path d="m4.93 4.93 14.14 14.14" />
                                <path d="m19.07 4.93-14.14 14.14" />
                            </svg>
                        </span>
                        Specializations
                    </h2>
                    <a *ngIf="!profile.specializations?.length" routerLink="/dashboard/interiordesigner/profile/edit"
                        class="text-xs text-purple-600 hover:underline">Add More</a>
                </div>
                <div class="flex flex-wrap gap-2">
                    <span *ngFor="let spec of profile.specializations; trackBy: trackByIndex"
                        class="px-3 py-1.5 bg-purple-50 text-purple-700 rounded-lg text-sm font-medium border border-purple-100">
                        {{ spec }}
                    </span>
                    <div *ngIf="!profile.specializations || profile.specializations.length === 0"
                        class="w-full py-4 text-center rounded-2xl bg-gray-50 border border-dashed border-gray-200">
                        <span class="text-gray-400 italic text-sm">No specializations listed.</span>
                    </div>
                </div>

                <!-- Certifications -->
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                        <span class="p-2 bg-amber-50 text-amber-600 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="8" r="6" />
                                <path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11" />
                            </svg>
                        </span>
                        Certifications
                    </h2>
                    <a *ngIf="!profile.certifications?.length" routerLink="/dashboard/interiordesigner/profile/edit"
                        class="text-xs text-amber-600 hover:underline">Add Certs</a>
                </div>
                <div class="space-y-3">
                    <div *ngFor="let cert of profile.certifications; trackBy: trackByIndex"
                        class="flex items-start gap-3 p-3 rounded-xl bg-amber-50/50 border border-amber-50">
                        <svg class="mt-0.5 text-amber-500 shrink-0" xmlns="http://www.w3.org/2000/svg" width="16"
                            height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                            <polyline points="22 4 12 14.01 9 11.01" />
                        </svg>
                        <span class="text-sm font-medium text-gray-800">{{ cert }}</span>
                    </div>
                    <div *ngIf="!profile.certifications || profile.certifications.length === 0"
                        class="py-4 text-center rounded-2xl bg-gray-50 border border-dashed border-gray-200">
                        <span class="text-gray-400 italic text-sm">No certifications currently listed.</span>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>